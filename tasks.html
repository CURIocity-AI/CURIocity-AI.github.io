<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airdrop Task - Curiosity ($CURI)</title>
    <link rel="stylesheet" href="style.css">
    <script type="module">
        import { db } from './auth.js';
        import { addDoc, collection } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-firestore.js";

        // Handle Proof Submission
        async function submitProof(event) {
            event.preventDefault();

            // Collect form data
            const wallet = document.getElementById("wallet").value.trim();
            const twitterLink = document.getElementById("twitterLink").value.trim();
            const telegramUsername = document.getElementById("telegramUsername").value.trim();

            // Validation
            if (!wallet || !twitterLink || !telegramUsername) {
                alert("Please complete all fields before submitting.");
                return;
            }

            try {
                // Save proof data to Firestore
                await addDoc(collection(db, "airdrop_proofs"), {
                    wallet,
                    twitterLink,
                    telegramUsername,
                    status: "Pending Review",
                    submittedAt: new Date().toISOString(),
                });

                // Redirect to success page
                window.location.href = "success.html";
            } catch (error) {
                console.error("Error submitting proof:", error);
                alert("‚ùå Failed to submit proof. Please try again later.");
            }
        }
    </script>
</head>
<body>
    <h1>üìã Airdrop Tasks</h1>
    <form id="proofForm" onsubmit="submitProof(event)">
        <input type="text" id="wallet" placeholder="Enter your wallet address" required>
        <p>* Must be a valid ERC-20 wallet</p>
        <input type="text" id="twitterLink" placeholder="Enter your Twitter Retweet Link" required>
        <p>* Retweet the pinned post</p>
        <input type="text" id="telegramUsername" placeholder="Enter your Telegram Username" required>
        <p>* Join our Telegram group</p>
        <button type="submit">Submit Proof</button>
    </form>
    <button class="back-button" onclick="goBack()">Back to Guide</button>

    <script>
        function goBack() {
            window.history.back();
        }
    </script>
</body>
</html>